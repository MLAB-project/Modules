<html><head><title>Evertool - combined AVR programmer and debugger</title>


<link type="text/css" rel="stylesheet" href="index_soubory/andreas_style.css"></head><body>
<h1>Evertool</h1>


<p><emph>Evertool is an AVRISP/STK500-protocol <b>and</b> JTAGICE compatible Programmer/JTAG debugger.</emph></p>
<ul>
<li>ISP Programmer compatible with Atmel AVRISP, directly accessable with AVRStudio and avrdude</li>
<li>JTAG debugger compatible with Atmel JTAGICE, directly accessable with AVRStudio and AVaRice</li>
<li>Evertool supports all AVR devices Atmel supports with their AVRISP and JTAGICE.</li>
<li>Easy update of the programmer for new target AVRs via RS232/serial port</li>
<li>Rescue clock generaration to recover from wrong fuse-bit-settings</li>
<li>Simple hardware, standard parts</li>
</ul>

<h3>Intro</h3>

<p>The ATMEL AVRISP In-System Programmer is a small device to program ATMEL AVR microcontrollers.
The original ATMEL AVRISP device is described <a href="http://www.atmel.com/dyn/products/tools_card.asp?tool_id=2726">here</a>.
To avoid misunderstandings: ATMEL's AVRISP is a "small STK500".
Evertool which emulates an AVRISP is not a "bit-bang-programmer" or an
AVR910-type-programmer. Evertool "talks" STK500-protocol on the
RS232-port since the STK500-firmware ATMEL delivers with the AVRStudio
is
used. From the programming interface the AVRISP is compatible with the
Atmel STK500 in low-voltage serial programming mode.<br>
The ATMEL JTAGICE is a device to program and debug ATMEL AVR microcontrollers with JTAG-Interface (ATmega16, ATmega32, 
ATmega64, ATmega128...) The ATMEL JTAGICE is described <a href="http://www.atmel.com/dyn/products/tools_card.asp?tool_id=2737">here</a>.</p>

<p>This is a rebuild of <b>both devices on a single board</b>. The main
advantage of such a programmer is the
compatibility with the ATMEL AVRstudio since it uses the original ATMEL
firmware code supplied with AVRStudio on an ATmega16 (JTAG) and
ATmega8535 (ISP). So the front-end software (AVRStudio) and programmer
firmware are supported by the makers of the target-controllers and new
devices should be supported
as soon as a new AVRStudio gets released with the new firmware-files
for STK500/AVRISP or JTAGICE. With the AVRStudio AVRISP/STK500-plug-in
programming of flash, eeprom, fuse- and lockbits is an easy task. The
JTAG part of Evertool is compatible with AVRstudio's JTAGICE plug-in.
And yes, it is possible "to jtag" the AVR Butterfly with Evertool.</p>

<p>Before you start you may concider this:</p>

<ul>

<li>The original ATMEL AVRISP device is cheap (prices May 2004: ca. 40 EUR incl. Tax at www.reichelt.de, 
ca. 26 EUR+TAX at de.digi-key.com). So if you don't need the JTAG-part this universal programmer may not be worth the effort.</li>

<li>The presented device has no ESD-protection IC or level-shifters on board. Refer to the 
<a href="http://www.atmel.com/dyn/resources/prod_documents/Avrisp_Sch.pdf">schematic of the original ATMEL AVRISP device</a>.
(Sorry, the schematic of the Atmel JTAGICE is not available here.) But since the AVR IO-pins have a rather good internal
protection this should not be a problem.</li>

<li>You need a programmer to build this programmer. A simple STK200-type dongle will do. Refer to the <a href="http://www.lancos.com/prog.html">
lancos.com PonyProg page</a>
which describes a simple programming interface. The dongle is only
needed for 10 minutes so you may borrow one from a friend. Another
AVRISP, an AVR910-type programmer or a STK500 will do too, of cause.
The programmer is just needed to program the special Evertool
bootloader into the ATmega16 once. Updating of Evertool to new
firmware(s) is done with the Evertool-bootloader - no additional
progammer needed.</li>

<li>If you are just interested in the JTAG-part: Rainer Radow made a
board based on the Evertool JTAG-section. This board only emulates
the JTAGICE. More information on <a href="#etlight">"Evertool-Light"</a> further down on this page.</li>

<li>If you are just interested in the AVRISP-part (although the original by ATMEL is cheap): see the 
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/avrispre/index.html">ispRE page</a>.</li>


</ul>

<p>Evertool has some extra functions:</p>
<ul>
<li>Rescue mode, so AVR controllers where the clock fuse bits have been set incorrectly can be reseted and reprogrammed</li>
<li>Power-supply to the target AVR-controller-board either from a
regulated source or from the onboard voltage regulator (3,3V and 5V).</li>
<li>Reset Button for target AVR (connected to the AVRISP-part)</li>
</ul>


<hr>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3972068798267869";
google_ad_width = 728;
google_ad_height = 150;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "336699";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript" src="index_soubory/show_ads.js">
</script><iframe name="google_ads_frame" src="index_soubory/ads.htm" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" frameborder="0" height="150" scrolling="no" width="728"></iframe>

</center>
<hr>


<h3>Changelog</h3>
<ul>
<li>29. Jun. 2004 - updated schematic, picture gallery.</li>
<li>30. Jun. 2004 - added "Evertool-light"</li>
<li>16. Sept. 2004 - added remark about "L"-type AVRs</li> 
<li>20. Sept. 2004 - updated schematic (power-supply), Hardware Version 0.9</li> 
<li>14. Jan. 2005 - updated Evertool schematic (JTAG VTG voltage-Divider). Thanks to Martin Kohout for spotting this.</li>
<li>28. Jan. 2005 - Remark about ATmega8535 chip-erase problem with bootloader version 0.2 in section "Software".</li>
<li>11. Feb. 2005 - Updated Bootloader binary (version 0.7)</li>
<li>7. Mar. 2005 - Remark about avrdude and STK500/AVRISP Firmware 2 in section "operation"</li>
<li>19. Apr. 2005 - moved Pull-up from PD4 to PD6. Thanks to Björn B.</li>
<li>17. Dec. 2005 - A current-limiting resistor (around 200 Ohm) should
be placed between the Target-Reset-Button and GND (Schematic will
be updated soon). Thanks to <a href="http://www.myevertool.de/">Dirk Büttner</a></li>
<li>24. Jan. 2006 - Information about how to program the AVR fuses with Ponyprog. Provided by Jeff Havens. Thank you, Jeff.
</li><li>2. Feb. 2006 - Added Step-by-Step guide for softare-installation on Evertool-LIGHT</li>
<li>8. Sept. 2006 - Evertool-based device with USB by Florian Schenk</li>
</ul>


<h3>License</h3>
<ul>
<li>The schematic is as free as ATMEL made their schematics freely available.</li>
<li>The layout is copyrighted. Free for non-commercial use. For commercial use please contact me by e-mail.</li>
<li>The bootloader is also copyrighted. Free for non-commercial use. For commercial use please contact me by e-mail.</li>
<li>It's also free to build yourself an Evertool for your work and just <b>use</b> the tool for programming/debugging.</li>
</ul>
<p>
Here commercial use is meant as: building and/or selling devices with the Evertool PCB-Layout with or without 
a preinstalled Evertool-Bootloader or selling the Evertool-Bootloader itself without hardware 
(as binary, source-code or programmed in a controller). Or just simply: If you earn money with my work,
you owe me a part of your profit. 
</p>


<h3>Hardware</h3>

<h4>Schematic</h4>

<p>Evertool V 0.9 Schematic</p>

<center>

<table>
<tbody><tr>
<td>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_schem_0_9b.png">
<img src="index_soubory/evertool_schem_0_9b_small.jpg">
</a>
<br>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_schem_0_9b.png">enlarge (2400*1600 png-Graphics)</a>
</td>
<td>
<script type="text/javascript"><!--
google_ad_client = "pub-3972068798267869";
google_ad_width = 120;
google_ad_height = 240;
google_ad_format = "120x240_as_rimg";
google_cpa_choice = "CAAQo-WbzgEaCPNnEyuh612cKM3B93M";
//--></script>
<script type="text/javascript" src="index_soubory/show_ads.js">
</script><iframe name="google_ads_frame" src="index_soubory/ads_002.htm" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" frameborder="0" height="240" scrolling="no" width="120"></iframe>
</td>
</tr>
</tbody></table>

</center>

<!--
<p>Evertool V 0.3 Layout SMD (<b>preliminary</b>)</p>
<center>
<img src="evertool_layout_0_3_small.png">
</center>
-->

<h4>Board</h4>

<p>
</p><center>
<img src="index_soubory/evertool_0_6_pcb.jpg"><br>
Evertool V 0.6 JMP Board - Thanks to Mark Pepper for makeing the prototype-PCB. @0lmx:&nbsp;first ;-) )
</center>
<p></p>

<p>Remarks:</p>
<ul>
<li> In this layout all "thru-hole"-parts are located on the backside. So a one-sided PCB with
some "wire-bridges" will do. Still around 100 holes to drill...</li>
</ul>

<p>Florian Schenk has created a device based on the Evertool-design with an USB-Interface (FTDI232-IC) and created a layout. See <a href="#etusb">below</a>.


</p><p>Main Parts:</p><p>

</p><ul>
<li>AVRISP-section
<ul>
<li>ATmega8535 or AT90S8535</li>
<li>MAX(3)232 (3,3V Version preferred)</li>
<li>2*5 pin-header</li>
<li>SUBD-9 Socket</li>
</ul>
</li><li>JTAGICE-section</li>
<ul>
<li>ATmega16</li>
<li>2  2*5 pin-headers</li>
</ul>
<li><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/partlist_0_5.txt">Complete Part-List the old Version 0.5.</a></li>
</ul>


<p>During development:</p>
<ul>
<li>any ISP capable AVR programmer (STK200-dongle, AVRISP, AVR910, STK500)</li>
</ul>

<p>Since Evertool can be powered by the target-system the MAX<b>3</b>232 (or compatible 
3.3V RS-232-interface-IC) is preferred for reliable programming and debugging of  3.3V target systems. 
Some "5Volt-MAX232" (or compatible) ICs are known to work at 3.3V. But I do not 
have any reliable source of information.</p>

<p>Two remarks about low-voltage ("L"-type) AVRs:</p>
<ul>
<li><a href="http://www.robotgames.net/atmel/mega8_or_mega8l.htm">Here</a> is an information from
the AVR Technical support.</li>
<li>Another <b>non</b>-offical information: The datasheets state that only L-type AVRs
should be used for voltages below 4.5V. According to the information I've got from some "insiders" 
(who do not work for ATMEL) there is no selection for "low-voltage" operation. The selection is done for 
controllers which do not work reliably at 16MHz. Those are labeled as "L"-type. So there should be no 
problem using "normal" (non-"L") AVRs with Evertool at 3.3V operation voltage. I have tested "normal" 
AVRs with my prototypes and had no problems with Vcc=3.3V. Since XTAL-frequencies for both 
Evertool-controllers are below 8MHz you may just select the type you can get cheaper.</li>
</ul>

<!-- Text vom Link: 
Is there actually a difference between the chips? 

Someone told me that the Mega8L chips were Mega 8L's that failed the 16MHz  speed tests.  I asked Atmel about this and this was their engineer's response:

    Dear Customer, 
    All versions are basically the same device. The only difference is that they are tested with different voltage levels and speed grads. There is no requalification of failing devices from one classification to another. As you can see by the definition of the voltage level and speed grades of the AVR devices, there is a clear relation between these settings. It is therefore very likely that a specific device from one classification will work within the specification limits of another classification. But this can never be guarantied from Atmel, due to the fact that that specific device is in production only tested within its own classification limits. 
    Best Regards,
    Atmel AVR Technical Support

So failed chips don't get sold off under a different label and it's very likely that a Mega8L will run at 16MHz  and a Mega8 will run at 2.7V.  Just note that they haven't been tested outside their specs and remember it's unlikely that either will run at 16MHz and 2.7V at the same time. 

Of course if you're buying a chip buy the one tested for the conditions you expect to use it under.  For me the decision was easy because on a Robot voltage tolerance can be an issue.  You don't want your Bot to coats to a halt in the middle of a bout because the voltage dipped below 4V.  I also don't care about the higher speed because I plan on using the internal clock which only goes up to 8MHz anyway
-->


<h4>Development-Prototype-Board</h4>

<center>
<img src="index_soubory/evertool_proto.jpg"> 
</center>

<h4><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/gallery/index.html">Picture Gallery</a></h4>


<h3>Software</h3>

<ul>
<li>The special Evertool-firmware (a "bootloader"). This bootloader
gets programmed into the ATmega16. The distribution-archive includes a
Windows batch-file for easier installation (see below). The installer
uses "AVRDUDE W32" which is also included. Make sure the driver
"give-io" is installed when a par-port-programmer (i.e. a
STK200-type-dongle) is used with WinNT/2k/XP. Give-io is also included.
Functions of the Evertool-bootloader: <ul>
	<li>UART-Bootloader to upload the ATMEL JTAGICE firmware into
the flash of the ATmega16 on the Evertool-board thru AVRStudio/AVRProg.</li>
	<li>AVR910-style
ISP programmer to program the ATMEL AVRISP firmware into the ATmega8535
on the Evertool-board thru AVRProg. The Evertool ATmega16 acts like the
AVR90S1200 in the original AVR910-design but the hardware UART and
hardware SPI of the ATmega16 are used instead of the "bit-bang" SPI and
software UART in the original design with an AVR90S1200. The Evertool's
bootloader programming support has only been tested with an ATmega8535
(also in AT90S8535-compatibility-mode) since this is the only Atmel
AVRISP/STK500 compatible controller.</li>
	<li>High speed clock generation for rescue clock.</li>
	</ul>

	Binary-distributions of the Evertool-bootloader. Only free for <b>non-commercial</b> use! 
	<ul>
	<li><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_SW07_HW09_PB0_20050211.zip">Version 0.7_HW09</a> (Timestamp 20050211). For the Hardware-Versions 0.7-&gt;1.1.
	</li><li><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_SW07_HW06_PA0_20050211.zip">Version 0.7_HW06</a> (Timestamp 20050211). For the Hardware-Version 0.6 JMP.
	</li><li><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_0_2_bin_20040601.zip"><b>Old</b> Version 0.2</a>
(Timestamp 20040601). This version has two issues in the ATmega8535
programming-module: (a) Sometimes AVRProg looses sync. Just press the
OK-Button if the Sync-Dialog appears on the screen. (b) The ATmega8535
can't be erased from the Evertool-Bootloader which causes errors during
upgrade of the AVRISP-firmware when there is already some code in the
ATmega8535 flash. Both issues have no influence on the ATmega16
JTAG-firmware update and have been fixed in version 0.7 and 1.1a.</li>
	</ul>

	Licensed users will find the commercial version 1.1a on the web-page mentioned in the Evertool manual.

</li><li>ISP-Programming software compatible to the programmer you've got from your friend (AVRDUDE, ponyprog, STK500-plungin etc.). 
To upload the bootloader into the ATmega16 and set the fuses and lock-bits in the ATmega8535 and ATmega16</li>
<li>AVRStudio 4 - AVRProg (from the tools-menu) is needed to upload the AVRISP-firmware and the JTAGICE-firmware which also
come with AVRStudio.</li>
</ul>

<hr>
<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3972068798267869";
google_ad_width = 728;
google_ad_height = 150;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "336699";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript" src="index_soubory/show_ads.js">
</script><iframe name="google_ads_frame" src="index_soubory/ads_003.htm" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" frameborder="0" height="150" scrolling="no" width="728"></iframe>
</center>
<hr>

<!--
There is a small error in the public bootloader-code (0.2): sometimes AVRProg looses sync. Just press the OK-Button if the Sync-Dialog appears on the
screen. In the commercial version of the bootloader this has been fixed. 
<br>
There is another small error in the 0.2-Bootloader: 
the ATmega8535 can't be erased from the Evertool-Bootloader which causes errors during upgrade of the AVRISP-firmware when there is already some code 
in the ATmega8535 flash. Workaround for Version 0.2: use another programmer (a "ParPort-Dongle" and PonyProg or avrdude will do) and erase the ATmega8535 
(Chip- or Flash-Erase) before uploading a new stk500-firmware (stk500.ebn) via the Evertool bootloader. The problem has been fixed in the commecial version 
a while ago and a new non-commercial binary will be available here soon after some testing of the "backport". This is a non-issue for Evertool-light, 
the internal ATmega16 "Application-Section-Erase" does work.
</li> 
-->


<h3>Step-by-Step Guide to Software-Installation</h3>

<ol>
<li>Build the board and double-check it.</li>
<li>Set the reset-select jumper near the ATMega16 to "ISP ATmega16".</li>
<li>Set the reset-select jumper near the ATMega8535 to "ISP ATmega8535".</li>
<li>Connect your programmer (STK200-dongle or whatever) to the ATmega16 ISP-Port.</li>
<li>Connect an external power supply to the Evertools board if STK200-PPI, AVRISP or AVR910-type programmer is used.</li>
<li>Upload the Evertool bootloader into the ATmega16 flash using
PonyProg or avrdude or whatever software can talk to you programmer.</li>
<li>Program the ATmega16 fuses and lock-bits (external high freq.
crystal, boot-reset, boot-size 1024 words, SPM in boot-section locked).</li>
<li>Connect your programmer (STK200-dongle or whatever) to the ATmega8535 ISP-Port.</li>
<li>Program the ATmega8535 fuses (external high freq. crystal, AT90S8535-compatibility flag (not needed - but can not do any harm)).</li>
<li>Set the reset-select jumper near the ATmega16 to "Normal/ATmega8535 programming".</li>
<li>Power-down the Evertool board.</li>
<li>Connect your PCs serial port to the Evertool board with a serial/RS232 cable.</li>
<li>Select the UART-Jumpers/Switch to connect to the ATmega16.</li>
<li>Close the "enable Bootloader (BL)" Jumper near the ATmega16.</li>
<li>Connect the ATmega16 ISP Pin-Header ("ISP mega16") to the ATmega8535 ISP Pin-Header ("ISP mega8535") with a 10-wire cable (You 
will need such a cable to connect Evertool to you target boards - so this is no extra part).</li>
<li>Power-up the board.</li>
<li>Start AVRStudio, start Tools/AVRProg. <b>(2)</b></li>
<li>Select "ATmega16 boot" from the AVRProg device selection.</li>
<li>Select [Browse] and browse to /programs/Atmel/AVR Tools/JTAGICE in
the file-dialog, select the file Upgrade.ebn (set filter to *.*).</li>
<li>Press the [Program] button in the "Flash" frame. Now the JTAGICE
firmware gets uploaded into the ATmega16 via "self-programming" aka
bootloader-programming and verified from the Evertool-bootloader.</li>
<li>Select "ATmega8515 boot" (yes: no typo. It's 8515 not 8535) from the AVRProg device selection.<b>(3)</b></li>
<li>Select [Browse] and browse /programs/Atmel/AVR Tools/STK500, select the file stk500.ebn (set filter to *.*).</li>
<li>Press the [Program]-Flash button. AVRProg will ask to continue
since the Flash "overwrites boot", select "continue". The next message
box will ask if the file should be truncated: say "no". Now the
Evertool-bootloader uploads and verifies the AVRISP firmware into the
ATmega8535 via serial-(in-system-)programming.<b>(4)</b></li>
<li>Power-down the board</li>
<li>Remove the cable between ATmega16 ISP-connector and ATmega8535 ISP-connector.</li>
<li>Open the Bootloader-Enable ("enable BL") Jumper near the ATmega16</li>
<li>Set the reset-select jumper near the ATMega8535 to "normal/AVRISP mode"</li>
<li>Done.</li>
</ol>

<b>Remarks:</b><br>
(1) n.t.<br>
(2) If the message box "No supported board found" appears on the screen
verify that no user software uses the COM-port, the UART-select
jumpers/switch are/is set to ATmega16/JTAG, the Evertool bootloader is
programmed into the ATmega16, the board is powered and the "enable
Bootloader"-jumper is set. You may also read the <a href="http://www.atmel.com/dyn/resources/prod_documents/DOC1021.PDF">AVRProg user guide</a>.<br>
(3) You may verify that the ISP connection between the ATmega16 and the ATmega8535 is established by pressing the [Advanced]
button while the device "ATmega8515 boot" is selected. The Advanced Screen should show the ATmega8535 device signature (see the
<a href="http://www.atmel.com/dyn/resources/prod_documents/doc2502.pdf">ATmega8535 datasheet</a>).<br>
(4) If you get verify-errors after the ATmega8535 programming first
verify that all connections and jumper settings are correct and
the signature-bytes can be read (Advanced Button). If there are still
problems press the Chip-Erase button in the advance stettings Chip
Erase for the Mega8535 is implemented in bootloader version 0.7 and
above.<br>


<p>The steps 1-10 are only needed for the first time to prepare the
"virgin" ATmegas. The binary-distribution of the Evertool bootloader
includes a setup-routine which will partly automate the steps 1-10
(flash upload and fuse-settings). All other steps are needed every time
the AVRStudio whants to update an AVRISP or JTAGICE to a new firmware.
Avoid letting AVRStudio do the updates automatically (it will not
work). Just cancel the "upgrade-dialogs" and follow the
"AVRProg-procedure" (Steps 11 to end) above.</p>

<p>A description how to program the ATmega16- and ATmega8535-fuses with PonyProg provided by Jeff Havens can be found on 
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/Evertool_fuses_PonyProg.html">this page</a>.

</p><p>The commercial version of the bootloader comes preprogrammed on
an ATMega16. No additional programmer ist needed for the initial
Evertool setup. There are no "overwrite" and "truncate" dialogs during
ATmega8535 programming when using the commercial version and the
ATmega8535 fuses are set to the correct values by the bootloader.</p>

<h3>Operation</h3>

<p>Depending on the UART-Jumpers/switch and the connection to the target the board now acts as an AVRISP or as a JTAGICE.</p>
<ul>
<li>Set the UART-jumpers to ATmega8535 and connect the target to the
ATmega8535 ISP pin-header (either 10pin "Kanda-standard" or 6pin "Atmel
standard") and the board will act as an
AVRISP/STK500-protocol-programmer which can be accessed from
AVRStudio's Tools-menue (or from AVRDUDE as programmer-type STK500).
See the Application-note <a href="http://www.atmel.com/dyn/resources/prod_documents/doc2521.pdf">AVR 042</a>
for pin-assigments.
avrdude 4.3.0 does not support the AVRISP/STK500 firmware version 2.x
which is shipped in the stk500.ebn-file of AVRStudio 4.11. An
experimental avrdude-Version with firmware version 2 support is
available from my <a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/index.html#avrdudew32">AVR-projects-page</a>.</li>
<li>Set the UART-jumpers/switch to ATmega16 and connect the target to the JTAG-header and the board will act 
as a JTAGICE which can be accessed from the AVRStudio Tools-menu.</li> 
<li><b>Special "Rescue"-Mode</b>: When the Bootloader-Enable jumper is
set during power-up a clock-signal (0,73MHz) is available at the
"Rescue-Clock" pin-header. With this clock-signal connected to the
XTAL1-pin of an AVR a misconfigured controller can be accessed and
reprogrammed. (helps with fuses: external clock-signal instead of
external crystal/quarz et.). Use the AVRISP part of Evertool to
reprogram the fuses with the AVRStudio STK500/AVRISP plug-in (the
JTAGICE part is not available if the ATmega16 is in
bootloader/rescue-mode).</li>
</ul>

The operation is described in the AVRStudio online-help. The AVRISP parts acts exactly as the original. The only extension is
the "Target Reset" button.<br>
The JTAGICE-Part <!-- may not show the target-voltage correctly but other functions (programming/debugging) work as expected and --> works as
described in the AVRStudio online-help. You may also use the JTAG-section with the <a href="http://avarice.sourceforge.net/">AVaRICE</a> 
interface-software to the gnu-debugger (gdb) on non-MS-Windows machines.


<h3>Questions and Answers</h3>


<!-- 
<p><cite>Are printed circuit boards available?</cite><br>
Coming soon! A bundle of a PCB (Version 1.1) and an ATmega16 preprogrammed with an improved version of the Evertool bootloader will
be available soon. All needed parts are "thru-hole" (see picture below) and easily available. No additional programming-hardware 
needed which means only the steps 12-end in the "step-by-step guide" above have to be done for firmware-installation. No additional
programming hardware needed. Kits with all needed parts and fully assembled and tested Evertools will follow. 
Please "stay tuned" for further information.</p>
<center><img src="et_pdip.jpg"><br>Layout and Picture (c) 2004 <a href="http://www.ispf.de">www.ispf.de</a></center>
-->

<p><cite>Are ready-made Evertools available?</cite><br>
Yes, see the <a href="http://www.myevertool.de/">Myevertool-Page</a>. The page is in German but you can contact
Mr. Büttner by e-mail in English. Myevertool is a sligthly modified version of the Evertool-design and has
a licensed version of the "commercial" Evertool-Bootloader preinstalled.</p>

<p><cite>Are printed circuit-boards available?</cite><br>
Yes, see the <a href="http://www.myevertool.de/">Myevertool-Page</a>. 
The page is in German but you can contact Mr. Büttner by e-mail in English (info (AT) myevertool [D O T] de).</p>

<p><cite>Can I have the Eagle-files?</cite><br>
No, I do not offer Eagle-Files neither schematic nor layout.</p>

<p><cite>Why two controllers?</cite><br>
Since the original Atmel firmwares are used, there have to be two
controllers. One for each task. It may be possible to extend the Evertool-bootloader
to emulate an STK500/AVRISP or AVR910-type programmer but I do not have enough
time and knowledge to keep this software up-to-date with every new AVR-device.</p>

<p><cite>Why no USB interface?</cite><br>
An USB to serial (RS232) converter has been tested succesfully with the Evertool prototyp-board. This
converter is avaialable for only 13EUR inlcuding cable at www.reichelt.de. A FT232/245 with USB-socket 
and cable is not cheaper in small amounts. For a device similar to the Evertool but with USB-Interace see <a href="#etusb">below</a>.</p>

<p><cite>Why SMD?</cite><br>
Well, no reason. It's my first SMD-project. Thought Evertool might be "nicer" in SMD.</p>

<p><cite>Does Evertool support Debugwire?</cite><br>
No. So far no MKII schematic is available for "inspiration" and the MKII Firmware coming
with AVRStudio seems to have another format than the ebn-files.</p>

<p><cite>AVRProg shows "No supported board found" - what's wrong?</cite><br>
Please double check your board and double check that all configuration-steps
have been done as described above before sending me an e-mail. You can test 
if the Bootloader is installed, the fuses are set correctly and the bootloader 
is active by using a terminal software (Hyperterm, Bray Terminal...). Set the terminal
to: 19200, 8N1, no flowcontrol, mount the "enable Bootloader (BL)"-Jumper,
apply power to the board, make sure the RS232-level-shifter is connected to
the ATmega16 and send a S (capital S) to the Evertool.
If everything is o.k. the bootloader will answer with the characters:
AVRBOOT. If not: double check...</p>


<hr>
<a name="etlight"></a>
<h2>"Evertool-Light"</h2>
<p>"Evertool-Light" is a stripped down version of Evertool which emulates the JTAGICE only. 
The design has been done by Rainer Rakow. The schematic is based on my Evertool design.
Basicly this is an extended version of the "BOOTICE"-design which can be found somewhere else. </p>

<center>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/light/etl_schem.jpg"><img src="index_soubory/etl_schem_t.jpg"></a>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/light/smd_side.jpg"><img src="index_soubory/smd_side_t.jpg"></a>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/light/connector_side.jpg"><img src="index_soubory/connector_side_t.jpg"></a>
<br>Click on the images for higher resolution pictures.
</center>

<p>
<a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/light/evertool_light_rr.zip">zip-Archive including schematic and PCB-layout (Postscript-files) of Evertool-Light</a> (ca. 180kB)
<br>(9.Jul.2004: Message from Rainer: the free end of resistor R2 should be connected to GND in his layout.)
</p>


<h3>Software-Installation on Evertool LIGHT</h3>

<ol>
<li>Build the board and double-check it.</li>
<li>Connect your programmer (STK200-dongle or whatever) to the ISP-Port.</li>
<li>Connect an external power supply to the Evertool-Light board if STK200-PPI, AVRISP or AVR910-type programmer is used.</li>
<li>Upload the Evertool bootloader (which can also be used for
Evertool-Light) into the ATmega16 flash using PonyProg or avrdude or
whatever software can talk to you programmer.</li>
<li>Program the ATmega16 fuses and lock-bits (external high freq.
crystal, boot-reset, boot-size 1024 words, SPM in boot-section locked -
lfuse:&nbsp;0xff hfuse:&nbsp;0xd8:m lock:&nbsp;0x2f).</li>
<li>Power-down the Evertool-Light board.</li>
<li>Connect your PCs serial port to the board with a serial/RS232 cable.</li>
<li>Close the "enable Bootloader (BL)" (JP3) Jumper</li>
<li>Power-up the board.</li>
<li>Start AVRStudio, start Tools/AVRProg. <b>(1)</b></li>
<li>Select "ATmega16 boot" from the AVRProg device selection.</li>
<li>Select [Browse] and browse to /programs/Atmel/AVR Tools/JTAGICE in
the file-dialog, select the file Upgrade.ebn (set filter to *.*).</li>
<li>Press the [Program] button in the "Flash" frame. Now the JTAGICE
firmware gets uploaded into the ATmega16 via "self-programming" aka
bootloader-programming and verified from the Evertool-bootloader.</li>
<li>Power-down the board</li>
<li>Open the Bootloader-Enable ("enable BL"/JP3) Jumper</li>
<li>Done.</li>
</ol>

<b>Remarks:</b><br>
(1) If the message box "No supported board found" appears on the screen
verify that no user software uses the COM-port, the UART-select
jumpers/switch are/is set to ATmega16/JTAG, the Evertool bootloader is
programmed into the ATmega16, the board is powered and the "enable
Bootloader"-jumper is set. You may also read the <a href="http://www.atmel.com/dyn/resources/prod_documents/DOC1021.PDF">AVRProg user guide</a>.<br>

<p>The steps 1-5 are only needed for the first time to prepare the new
ATmega16. The binary-distribution of the Evertool bootloader includes a
setup-routine which will partly automate the steps 1-5 (flash upload
and fuse-settings). All other steps are needed every time the AVRStudio
whants to update the JTAGICE to a new firmware. Avoid letting AVRStudio
do the updates automatically (it will not work). Just cancel the
"upgrade-dialogs" and follow the "AVRProg-procedure" (Steps 6 to end)
above.</p>


<center>
<script type="text/javascript"><!--
google_ad_client = "pub-3972068798267869";
google_ad_width = 728;
google_ad_height = 150;
google_ad_format = "728x90_as";
google_ad_channel ="";
google_color_border = "336699";
google_color_bg = "FFFFFF";
google_color_link = "336699";
google_color_url = "008000";
google_color_text = "000000";
//--></script>
<script type="text/javascript" src="index_soubory/show_ads.js">
</script><iframe name="google_ads_frame" src="index_soubory/ads_004.htm" marginwidth="0" marginheight="0" vspace="0" hspace="0" allowtransparency="true" frameborder="0" height="150" scrolling="no" width="728"></iframe>
</center>


<hr>
<a name="etusb"></a>
<h2>"Evertool-USB"</h2>

<p>Florian Schenk has extended the Evertool with an USB-Interface (FTDI232-USB-to-serial IC). He has also created a layout. 
The schematic and the Eagle-files (.brd and .sch) can be downloaded from <a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/evertool/evertool_usb_v1.zip">[here]</a> (timestamp 20060908).
If you have questions you may ask Florian Schenk directly by e-mail (schenk (At) schema2000 (Dot) de).</p>

<p>I (M.Thomas) do not offer any support for this ET-USB-design. I have
not reviewed the layout and I do not own such a device. Anyway, at
least a remark from my side: Take care about the voltage-supply. When
the jumper near the USB-connector of "ET-USB" is closed VCC for the
complete device is 5V and
the levels at the ISP- and JTAG-connectors are also near 5V. This is a
"no-no" when connecting to a 3,3V target. If in doubt leave the
supply-jumper near the USB-connector open and supply the ET-USB from
the target-board.</p>



<hr>

<p><a href="http://www.siwawi.arubi.uni-kl.de/avr_projects/index.html"> back to my AVR projects page</a></p>

<hr>
Martin Thomas<br>
<img src="index_soubory/mtmailadr2.jpg" alt="e-mail: mthomas (AT) rhrk (D O T) uni-kl (DOT) de"><hr>
<p align="right">
	<small>
	<font color="#aaaaaa">
	<br>21436 hits since 
	<br>Last mod.: Wednesday, 29-Aug-2007 03:27:24 CEST
	<br><!--   # echo var="REMOTE_HOST" -->
	</font>
	</small>
</p>

</body></html>